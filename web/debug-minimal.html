<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Minimal Debug</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div id="loadingOverlay" class="loading-overlay">
        <div class="loading-content">
            <div class="spinner"></div>
            <p id="loadingText">Loading images...</p>
        </div>
    </div>
    
    <div style="padding: 20px; position: relative; z-index: 10000;">
        <h1>Debug Console</h1>
        <button onclick="testSequence()">Test Full Sequence</button>
        <pre id="console" style="background: #f0f0f0; padding: 10px; margin-top: 10px; height: 400px; overflow-y: auto;"></pre>
    </div>

    <script src="js/utils.js"></script>
    <script src="js/api.js"></script>
    <script>
        // Capture all console output
        const consoleDiv = document.getElementById('console');
        const originalLog = console.log;
        const originalError = console.error;
        
        function logToDiv(message, type = 'log') {
            const timestamp = new Date().toLocaleTimeString();
            consoleDiv.textContent += `[${timestamp}] ${type.toUpperCase()}: ${message}\n`;
            consoleDiv.scrollTop = consoleDiv.scrollHeight;
        }
        
        console.log = function(...args) {
            originalLog.apply(console, args);
            logToDiv(args.join(' '), 'log');
        };
        
        console.error = function(...args) {
            originalError.apply(console, args);
            logToDiv(args.join(' '), 'error');
        };

        async function testSequence() {
            try {
                console.log('=== Starting test sequence ===');
                
                // Test 1: Check DOM elements
                console.log('1. Checking DOM elements...');
                const overlay = document.getElementById('loadingOverlay');
                const text = document.getElementById('loadingText');
                console.log('Loading overlay found:', !!overlay);
                console.log('Loading text found:', !!text);
                
                // Test 2: Test Utils functions
                console.log('2. Testing Utils.showLoading...');
                Utils.showLoading('Test loading...');
                console.log('Loading shown, overlay hidden status:', overlay.hidden);
                
                await new Promise(resolve => setTimeout(resolve, 1000));
                
                // Test 3: Test API call
                console.log('3. Testing API call...');
                const images = await api.getImages();
                console.log('API response:', images);
                
                // Test 4: Test Utils.hideLoading
                console.log('4. Testing Utils.hideLoading...');
                Utils.hideLoading();
                console.log('Loading hidden, overlay hidden status:', overlay.hidden);
                
                console.log('=== Test sequence complete ===');
                
            } catch (error) {
                console.error('Test sequence failed:', error);
                console.error('Error stack:', error.stack);
            }
        }
        
        // Auto-run when page loads
        window.addEventListener('load', () => {
            console.log('Page loaded');
            setTimeout(testSequence, 1000);
        });
    </script>
</body>
</html>
